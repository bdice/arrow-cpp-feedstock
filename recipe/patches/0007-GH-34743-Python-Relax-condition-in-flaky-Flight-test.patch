From cff944edcee6ef9353ab1c8acee193556cc40572 Mon Sep 17 00:00:00 2001
From: David Li <li.davidm96@gmail.com>
Date: Fri, 31 Mar 2023 11:57:35 -0400
Subject: [PATCH 7/9] GH-34743: [Python] Relax condition in flaky Flight test
 (#34747)

### Rationale for this change
This test is consistently flaky on AMD64 macOS.

### What changes are included in this PR?

Relax the test condition a bit.
### Are these changes tested?

This is a change to a test.

### Are there any user-facing changes?

No.
* Closes: #34743

Authored-by: David Li <li.davidm96@gmail.com>
Signed-off-by: Will Jones <willjones127@gmail.com>
---
 python/pyarrow/tests/test_flight.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/python/pyarrow/tests/test_flight.py b/python/pyarrow/tests/test_flight.py
index 28ace4f93..f6c0ab978 100644
--- a/python/pyarrow/tests/test_flight.py
+++ b/python/pyarrow/tests/test_flight.py
@@ -1972,7 +1972,7 @@ def test_generic_options():
         client = flight.connect(('localhost', s.port),
                                 tls_root_certs=certs["root_cert"],
                                 generic_options=options)
-        with pytest.raises(pa.ArrowInvalid):
+        with pytest.raises((pa.ArrowInvalid, flight.FlightCancelledError)):
             client.do_get(flight.Ticket(b'ints'))
         client.close()
 
